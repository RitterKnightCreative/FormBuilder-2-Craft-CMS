{% extends "_layouts/cp" %}
{% import "_includes/forms" as forms %}

{% hook 'formBuilder2.prepCpTemplate' %}

{% set selectedSubnavItem = "forms" %}
{% set bodyClass = 'formbuilder fb-templates-edit' %}
{% set pageSlug = craft.request.lastSegment %}

{% if pageSlug == 'edit' %}
    {% set page = 'Edit Template' %}
{% else %}
    {% set page = 'New Template' %}
{% endif %}

{% block pageHeader %}
    {% include 'formbuilder2/_includes/_header' ignore missing with { title: page } %}
{% endblock %}

{% block main %}
    {% set errors = template.getErrors() %}

    <input type="hidden" name="action" value="formBuilder2/template/saveTemplate">
    <input type="hidden" name="redirect" value="formbuilder2/templates">
    <input type="hidden" name="type" value="{{ type }}">

    {% if template.id %}
        <input type="hidden" name="templateId" value="{{ template.id }}">
    {% endif %}

    {% include 'formBuilder2/templates/layouts/_' ~ type %}

    {% includeJsResource "formbuilder2/js/forms.js" %}
    {% includeJsResource "formbuilder2/js/templates.js" %}
    {% includejs %}
        $('.section-collapsible').each(function(i,el){
            new FormBuilderSection(el);
        });
    {% endincludejs %}

{% endblock %}